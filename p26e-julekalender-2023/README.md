# p26e Julekalender 2023 (PST)

## 1. Desember - mobil-detektiven

```
Her f√•r du den f√∏rste oppgaven!

Under etterforskningen av hendelsen p√• jule-verkstedet har vi oppdaget noe rart. Et av meldingssystemene som sender varslinger til beredskapsvaktene for verkstedet har sendt en SMS til et ukjent nummer. Meldingen er dessverre helt uleselig for oss, s√• vi trenger dine mobildetektiv-egenskaper. N√•r du finner ut av det, send meg svar p√• formatet PST{ditt svar her}.

7-4 9-3 7-4 8-1 3-2 6-1 0-1
4-3 6-2 3-3 4-3 7-4 3-2 7-3
8-1 0-1 4-1 7-3 8-2 6-2 5-2
3-2 7-3 0-1 4-3 6-2 2-3 6-3
6-1 4-3 6-2 4-1

- Tastefinger
```

F√∏rste dagen som alvebetjent "helf" gikk jeg litt full kodeknekkemodus med rot-13 og feilet ganske fort. Som tittel, brev og avsender hinter til, er dette telefonrelatert, spesifikt de gamle NOKIA-type telefon med 12~ knapper, blant annet 0-9 som representerer det f√∏rste tallet i meldingen, og antall ganger det skap trykkes blir mappet til en bokstav. Husker eda n√•r det var "inn" √• v√¶re rask p√• disse. \
resultatet blir da:

```
PST{SYSTEM INFISERT GRUNKER INCOMING}
```

vi f√•r 10 poeng p√• tavla og en vittig melding fra tastefinger

```
ü§¶üèª
- Tastefinger
```

## 2. Desember - Scrambled
```
Over natten har det v√¶rt store utfordringer knyttet til en av maskinene i verkstedet. En serie feilproduserte leker har kommet p√• rullende b√•nd. Vi pr√∏ver √• finne ut hva som har skjedd. Graver du ned i det her?

- Mellomleder

üìéBilde
```
Bildet viser noen √∏delagte leket√∏y, men det som stikker seg ut er bokstaver p√• firkantet fargebakgrunn. Det viser seg √• v√¶re en "√•pnet" rubikskube. Strategien var da √• finne ut hvordan denne kuben s√• ut som "l√∏st". Jeg har aldri l√∏st en rubiks kube med strategi, men jeg vet fra barndommen at det g√•r ann √• demontere en og s√• "pusle" de tilbake. Med tunga rett i munnen la jeg ut seks post-it lapper og manuelt l√∏ste kuben, samlet de p√• en stor firkantet matboks og l√∏sningen kunne man lese fra { til }, og R√∏d side hadde PST (og litt blank data):
```
PST{l√∏ste_du_denne_som_puslespill_eller_kube?:)}
```

```
Her var det mye r√∏re! Bra du klarte √• finne ut av det!
- Mellomleder
```

## 3. Desember - Redacted

```
Det er krise! Filene p√• alvemaskinene har blitt kryptert, og vi har ingen backups tilgjengelig!

P√• nissens skrivebord fant vi det vedlagte brevet, sammen med en kryptert fil.

Det er ubeskrivelig viktig at vi f√•r √•pnet denne filen igjen umiddelbart, da Jule NISSEN ikke klarer √• huske innholdet!

- Mellomleder

üìé Mitt utpressingsbrev.docx
üìé huskeliste.txt.enc 
```

placeholder

```
KRIPOS{Husk √• se etter spor i sn√∏en!}
```

```
Flott!

Jeg kaller inn til et m√∏te med Jule NISSEN og de andre p√•virkede s√• vi kan f√• delt ut informasjonen igjen.
- Mellomleder
```

## 4. Desember - pinneved

```
Alvebetjentene p√• Jule NISSEN sitt verksted v√•knet i dag til et fryktelig syn; Julenissens slede er sprengt i fillebiter. Vi har satt folk p√• saken for √• finne ut av hvem som er ansvarlig for √∏deleggelsen, men det er kritisk at sleden blir reparert slik at vi f√•r testet den f√∏r Jule NISSEN skal levere pakkene.

Alvebetjentene har samlet vrakrestene, samt verkt√∏yet de mistenker at sabot√∏rene har brukt.

Vi trenger at du rekonstruerer sleden s√• fort som mulig!

- Tastefinger

üìé pinneved.py
üìé pinneved.txt
```

```
PST{ASCII_art_er_kult}
```

```
Et faktisk kunstverk! Godt jobbet!
Vi setter i gang testingen sporenstreks.
- Tastefinger
```



## 5. Desember - Mulvarpjakt


```
Gjennom temmelig hemmelige innhentingsmetoder har vi fanget opp en melding om et n√¶rt forest√•ende m√∏te p√• Fastlands-Norge mellom en mistenkt kildef√∏rer som jobber for sydpolare tjenester og et ukjent objekt vi mistenker kan v√¶re en muldvarp.

For at v√•re spaningsalver skal settes i stand til √• observere m√∏tet og identifisere det ukjente objektet m√• vi vite hvor vi skal sende v√•re alver.

Vi pr√∏vde √• sp√∏rre OSINT-alvene v√•re, men de var travelt opptatt med √• saumfare sosiale medier etter snille og slemme barn. De mumlet noe om at vi kunne fikse det selv med ‚Äúturbo overgang‚Äù.

Kan du ut fra meldingen finne ut hvor de skal m√∏tes?

    Ta bussen og g√• av p√• holdeplassen rett ved begravelsesbyr√•et som ligger inntil en sj√∏matbutikk. Jeg vil st√• klar ved fontenen noen titalls meter fra bussholdeplassen. N√•r du har kommet frem til fontenen, vil vi sammen g√• til det n√¶rliggende biblioteket som ligger under 50 meter fra fontenen og gjennomf√∏rer overf√∏ringen.

Svar meg med navnet p√• m√∏testedet og p√• formen PST{BERGEN LUFTHAVN}

- Tastefinger
```

Geolokasjon / OSINT verkt√∏y er noe jeg aldri har tatt i bruk. Som hintet i vrevet fra Tastefinger kan man bruke Overpass Turbo til √• finne en lokasjon som passer beskrivelsen i meldingen.\
Overpass Turbo "kodesnutten" her finner to lokasjoner, som er god nok filtrering til √• se at Dr√∏bak sentrum er hvor m√∏te er. N√∏yaktig p√• frogner bibliotek.
```
area
  ["ISO3166-1"="NO"]
  ["admin_level"="2"];
out geom;

node(area)[highway=bus_stop];
node(around:30)[amenity=restaurant];
node(around:90)[amenity=fountain];
node(around:50)[amenity=library];
out;
```
logikken i l√∏sningen er √• filtere p√• norge, siden busstoppet var rett med resturant (30 meter magic guess), titalls meter til fontenen (90m med litt slark fra resturanten) som igjen var 50m unna biblioteket.

<img alt="Resultat over norge" src="https://github.com/BirkJohannessen/writeups/blob/master/p26e-julekalender-2023/05mulvarpjakt/turbo2.png">
<img alt="Dr√∏bak sentrum" src="https://github.com/BirkJohannessen/writeups/tree/master/p26e-julekalender-2023/05mulvarpjakt/turbo1.png">
```
PST{FROGN BIBLIOTEK}
```

```
Ypperlig! N√• har vi dem! :)
- Tastefinger
```


## 6. Desember - KAKER-kontroll

```
I en standard KAKER-kontroll (Kontroll Av Kommunik√© med Eksport-Restriksjoner) har det blitt tatt en kopi av dette dokumentet. Vi syns det er snodig at akkurat denne personen har hatt med seg dokumentet siden personen har hatt anti-jul-holdninger tidligere, og vi vil derfor at du tar en n√¶rmere kikk for √• se etter uhumskheter.

- Tastefinger

PE‚ÄçPPERKAKER {
    POR‚ÄçSJONER {
        20 kaker
    }
    ‚ÄçTYPE ‚Äç{
        julekake
    }
    INGREDIENSER {
        KAKEDEIG {
            2 ts ‚ÄçPepper
            2 ts Malt ing‚Äçef√¶r
            0,5 ts Malt nellik
            3 dl M√∏rk siru‚Äçp
            300 g Sm√∏r
            2 ts Malt kanel
            4 ts Natron
            2 stk. Egg
            300 g Sukker
            ca. 900 g Hvetemel
        }
        MELISGLASUR {
            ca. 250 g Melis
            1 stk. Eggehvite
            0,5 ts Sitronsaft
        }
    }
    OPPSKRIFT {
        STEG1 { Bland sm√∏r, siru‚Äçp og sukker i en kjele. Varm opp til sukkeret er sm‚Äçeltet. Tilsett nellik, ingef√¶‚Äçr, pepper og kanel, og r√∏r godt sammen. }
        STEG2 { Ta ‚Äçkjelen av platen og avkj√∏l bl‚Äçandingen noe. R√∏r inn egg. }
        STEG3 { Ha i natron, og si‚Äçkt inn mel. R√∏r alt sammen til ‚Äçen jevn deig. Deigen skal v√¶‚Äçre ganske myk og klissete, den vil bli mye hardere n√•r den blir kald! }
        STEG4 { Hell deigen over i en bolle og dryss litt hvetemel p√• toppen. Dekk til med litt plastfolie og sett deigen kaldt noen timer, gjerne over natten. }
        STEG5 { Skj√¶r l√∏s et stykke av deigen. Plasser resten av deigen tilbake i kj√∏leskapet. ‚ÄçElt deigen forsiktig. Tilsett litt me‚Äçr mel om den virker for myk. }
        STEG6 { ‚ÄçMel en flate, ‚Äçog kjevle deigen ut til ca 3 mm tykkelse. Det er enklest n√•r deigen er myk som plas‚Äçtilina. Stikk ut pepperkakefigurer og flytt dem over p√• et ‚Äçbakepapirkledd stekebrett. Samle restene av deigen og legg den kaldt. Skj√¶r ut et n‚Äçytt stykke av ‚Äçdeigen og gjenta prosessen. Deigen blir vanskelig √• jobbe med n√•r den blir for varm, s√• da kan d‚Äçen f√• hvile i kj√∏leskapet igjen. }
        STEG7 { Stek kakene midt i stekeovnen p√• 175 ¬∞C i ca. 10 minutter. Avkj√∏‚Äçl kakene helt p√• rist. }
        STEG8 { Bland sammen mel‚Äçis, eggehvite og sitronsaft til en tykk ‚Äçglasur, og dekorer kaken‚Äçe. }
    ‚Äç}
}
```

Som en stolt vim entuiast limte jeg denne oppskriften inn i et buffer - Og der var svaret umiddelbart. Vim encoder ikke spesialbytes som andre teksteditorer, men printer de i <> format. Svaret var samlingen av bokstaven etter <200d> byten som vist p√• bilde.

```
PST{pepperkakerermotbydelige}
```

```
Hvordan kan man ikke like pepperkaker?!
- Tastefinger
```


## 7. Desember - Alle gode ting er tre

```
Alveresepsjonen fant en mystisk lapp i postboksen til Nissens verksted i dag tidlig. Vanligvis er dette noe Ronny, Shahana og Ada fra alvdeling for kryptografi ville tatt seg av. Dessverre er alle tre bortreist p√• en viktig konferanse i San Francisco for √• h√∏re om den siste utviklingen innen eksponenter og modul√¶r aritmetikk. Kan du steppe inn for dem og finne ut av hva denne beskjeden egentlig er for noe?

- Mellomleder

üìémsg.txt
```
msg inneholder en fil med tre verdier:
```
N = 0x5993c05eac819aa17ae7e4e4b9f75b2d6fdbaec913e0b2d6f4ba585a991b62279ed9ac53aeadee3327321e02c0c06ecda184952df5d1cc8b3024643c0afdd9bbd52bf2d830f54d6e59e76844394eb0ffc498995dd270b9b95bf1614984472a3ef12d8c1bad64529be7b638c5d0fccf61c5ac2ab4564e5215748eb2533d4d949afd9486426dbf0c06a07c2c0f6d482e4f8cf3052e6ab9df20878b747936d590c3b8bb0219a378cbec03baee4ea8d0641c57bcc18706bbe92c3f2d7569c424062d9b79464958419b4000e3e31c077bba27ef2fc6ed15b7ebdcdb41d1cbf7708737e200904015d341ef94c537a916f1fec61e0b1bf64762e5a97bafdde290b939c3
e = 3
C = 0x755040806d1d699c76cf2b3fffc28ad8831a8667e1b064297a43733b89f6272483a5a728b725d02b069f8fc65eb51d89ce9133df8f5f2d5e13f63c5423021eb2b56eeb91b11d78717528dfce169450a08d40f5ab451c8ac1f8c6875cffbd4d70259d436ed70baeae37b9bdafc5965
```
Med litt hint fra meldingen (Ronny, Shahana og Ada - RSA) er dette verdier i RSA algoritmen.\
Min l√∏sning for dekryptering var med [RsaCtfTool](https://github.com/RsaCtfTool/RsaCtfTool) med N og E som parametere, og C som ciphertext.
```
./RsaCtfTool.py -n 0x5993c05eac819aa17ae7e4e4b9f75b2d6fdbaec913e0b2d6f4ba585a991b62279ed9ac53aeadee3327321e02c0c06ecda184952df5d1cc8b3024643c0afdd9bbd52bf2d830f54d6e59e76844394eb0ffc498995dd270b9b95bf1614984472a3ef12d8c1bad64529be7b638c5d0fccf61c5ac2ab4564e5215748eb2533d4d949afd9486426dbf0c06a07c2c0f6d482e4f8cf3052e6ab9df20878b747936d590c3b8bb0219a378cbec03baee4ea8d0641c57bcc18706bbe92c3f2d7569c424062d9b79464958419b4000e3e31c077bba27ef2fc6ed15b7ebdcdb41d1cbf7708737e200904015d341ef94c537a916f1fec61e0b1bf64762e5a97bafdde290b939c3 -e 3 --decrypt 0x755040806d1d699c76cf2b3fffc28ad8831a8667e1b064297a43733b89f6272483a5a728b725d02b069f8fc65eb51d89ce9133df8f5f2d5e13f63c5423021eb2b56eeb91b11d78717528dfce169450a08d40f5ab451c8ac1f8c6875cffbd4d70259d436ed70baeae37b9bdafc5965
```

```
NSM{af0dbd13cee45990593c182b213f978d}
```

```
Jeg tror jeg trenger hele alvdelingen for kryptografi for √• forst√• meg p√• denne her, men bra du fikk det til!
- Mellomleder
```


## 8. Desember


## 9. Desember


## 10. Desember


## 11. Desember


## 12. Desember


## 13. Desember


## 14. Desember


## 15. Desember


## 16. Desember


## 17. Desember


## 18. Desember


## 19. Desember


## 20. Desember


## 21. Desember


## 22. Desember


## 23. Desember


## 24. Desember
